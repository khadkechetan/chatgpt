import pandas as pd

# Sample data
data = {
    'Product': ['A', 'A', 'B', 'B', 'C'],
    'Region': ['North', 'South', 'North', 'South', 'North'],
    'Sales': [250, 150, 200, 100, 300],
    'Profit': [50, 60, 70, 80, 90]
}

df = pd.DataFrame(data)

# Create pivot table with multi-level columns
pivot_table = pd.pivot_table(
    df,
    values=['Sales', 'Profit'],
    index='Product',
    columns='Region',
    aggfunc='sum'
)

# Export the pivot table with the hierarchical structure preserved
with pd.ExcelWriter('pivot_output.xlsx', engine='openpyxl') as writer:
    pivot_table.to_excel(writer, sheet_name='PivotTable')
    worksheet = writer.sheets['PivotTable']
    
    # Auto-adjust column widths
    for col in worksheet.columns:
        max_length = 0
        column = col[0].column_letter
        for cell in col:
            try:
                if len(str(cell.value)) > max_length:
                    max_length = len(cell.value)
            except:
                pass
        adjusted_width = (max_length + 2)
        worksheet.column_dimensions[column].width = adjusted_width
